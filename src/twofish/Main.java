package twofish;

import java.util.Arrays;

public class Main {


    static int[] key = { 0x28, 0x2B, 0xE7,
            0xE4, 0xFA, 0x1F,
            0xBD, 0xC2, 0x96,
            0x61, 0x28, 0x6F,
            0x1F, 0x31, 0x0B,
            0x7E
    };
    static int[] plainText= { 0x28, 0x2B, 0xE7, 0xE4, 0xFA, 0x1F, 0xBD, 0xC2, 0x96, 0x61, 0x28, 0x6F, 0x1F, 0x31, 0x0B, 0x7E
    };

    static int[] decKey = {0x35, 0xD2, 0x4D, 0xEE, 0xF3, 0x8E, 0x98, 0xA4, 0x9F, 0xE6, 0xB3, 0x85, 0xD9, 0x93, 0x0F, 0xC0};
    static int[] decpt = {0xD5, 0x18, 0x7E, 0x7D, 0x6B, 0x8B, 0xE9, 0x51, 0x7D, 0xAC, 0x4A, 0x8A, 0xF4, 0xA5,0x52, 0xEA};

    //работает в паре с key=keyIval ecb vt
    //ecb vk тоже работает
    static int[] vtpt = {
            0x20, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0
    };
    static int[] tblpt = {
            0x9F, 0x58, 0x9F, 0x5C, 0xF6, 0x12, 0x2C, 0x32, 0xB6, 0xBF, 0xEC, 0x2F, 0x2A, 0xE8, 0xC3, 0x5A
    };

    public static void main(String[] args) {

        final byte[] encResult = TwofishWrapper.processECB(Util.unsignedToSigned(keyIval), true,
                Util.unsignedToSigned(tblpt));

        final byte[] decResult = TwofishWrapper
                .processECB(Util.unsignedToSigned(keyIval), false, encResult);

        System.out.println(" PT:  " + Util.bytesToHex(Util.unsignedToSigned(tblpt)) + "\n DEC result:  "
                + Util.bytesToHex(decResult)
                + "\n encRes: " + Util.bytesToHex(encResult)
        );

        decryptionECB();
    }

    private static void decryptionECB(){

        final byte[] decResult = TwofishWrapper
                .processECB(Util.unsignedToSigned(keyIval), false, Util.unsignedToSigned(keyIval));
        System.out.println("\n DEC result:  "
                + Util.bytesToHex(decResult));
    }



    static int[] keyIval = { 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0
    };
    static int[] plainTextIval= { 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0
    };

    static int[] keyIval192 = {
            0x01, 0x23, 0x45, 0x67, 0x89, 0xAB, 0xCD, 0xEF, 0xFE, 0xDC, 0xBA, 0x98, 0x76, 0x54, 0x32, 0x10, 0x00,
            0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77
    };
    static int[] ptIval192 = { 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0
    };

    private static void ecbIval() {
        final byte[] encResult = TwofishWrapper.processECB(Util.unsignedToSigned(keyIval192), true,
                Util.unsignedToSigned(ptIval192));

        final byte[] decResult = TwofishWrapper
                .processECB(Util.unsignedToSigned(keyIval192), false, encResult);

        System.out.println(Util.bytesToHex(Util.unsignedToSigned(ptIval192)) + " bbbbbbbb " + Util.bytesToHex(decResult)
                + " bbbbbbbb " + Util.bytesToHex(encResult) + " bbbbbbbb " + Arrays.toString(encResult) + encResult.length
        );
    }
}
